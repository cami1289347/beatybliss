<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pago - Beauty Bliss</title>
  <link rel="stylesheet" href="style.pago.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&family=Playfair+Display:wght@500;600&display=swap" rel="stylesheet">
</head>
<body>

<header class="cabecera">
  <div class="header-top">
    <img src="logo.png" alt="Beauty Bliss Logo" class="logo">
    <input type="text" class="buscador-header" placeholder="Buscar productos...">
    <div class="icons">
      <a href="registro.html" title="Usuario"><i class="fas fa-user"></i></a>
      <a href="#" title="Favoritos"><i class="fas fa-heart"></i></a>
      <a href="#" title="Carrito"><i class="fas fa-shopping-cart"></i></a>
      <a href="contacto.html" title="Contacto"><i class="fas fa-phone"></i></a>
    </div>
  </div>

  <nav class="main-nav">
    <a href="index.html">Inicio</a>
    <a href="cuidado-de-la-piel.html">Cuidado Facial</a>
    <a href="cabello.html">Cabello</a>
    <a href="labios.html">Labios</a>
    <a href="uñas.html">Uñas</a>
  </nav>
</header>

<a href="javascript:history.back()" class="btn-volver">
  <i class="fas fa-arrow-left"></i> Volver
</a>

<div class="contenedor-pago">
  <div class="resumen-compra">
    <h2>Resumen de Compra</h2>
    <div id="lista-productos">
      <!-- Productos dinámicos -->
    </div>
    <div class="total-compra">
      <p>Total: <span id="total-carrito">S/ 0.00</span></p>
    </div>
  </div>

  <div class="proceso-pago">
    <h2>Resumen de Pago</h2>
    <p id="total-pago" class="total-compra">Total: S/ <span id="total-pago-valor">0.00</span></p>
    
    <button class="boton-pago" id="btn-realizar-pago">Realizar Pago</button>

    <div class="metodo-pago">
      <h3>Selecciona el Método de Pago</h3>
      <div class="opciones-pago">
        <div class="opcion-pago active" onclick="mostrarFormularioTarjeta()">
          <i class="fas fa-credit-card"></i> Tarjeta
        </div>
        <div class="opcion-pago" onclick="mostrarQR()">
          <i class="fas fa-mobile-alt"></i> Yape/Plin
        </div>
      </div>
    </div>

    <div class="formulario-tarjeta">
      <h4>Formulario de Pago con Tarjeta</h4>
      <div class="input-group">
        <label>Nombre del Titular</label>
        <input type="text" id="nombre-titular" placeholder="Ej: María López">
      </div>
      <div class="input-group">
        <label>Número de Tarjeta</label>
        <input type="text" id="numero-tarjeta" placeholder="0000 0000 0000 0000">
      </div>
      <div class="fila-inputs">
        <div class="input-group">
          <label>Fecha Expiración (MM/AA)</label>
          <input type="text" id="fecha-expiracion" placeholder="MM/AA">
        </div>
        <div class="input-group">
          <label>CVV</label>
          <input type="text" id="cvv" placeholder="123">
        </div>
      </div>
      <button class="boton-pago" onclick="procesarPagoTarjeta()">Pagar con Tarjeta</button>
    </div>

    <div class="qr-container">
      <h4>Pago con Yape/Plin</h4>
      <div class="qr-code">
        <img src="codigoqr.jpg" alt="Código QR">
        <p>Nombre de la tienda: Beauty Bliss</p>
      </div>
      <button class="boton-pago" id="btn-pagado">Ya Pagué</button>
    </div>
  </div>
</div>

<script>
  let carrito = JSON.parse(localStorage.getItem('carrito')) || [];

  function actualizarCarrito() {
    const listaProductos = document.getElementById('lista-productos');
    listaProductos.innerHTML = '';
    let total = 0;
    
    carrito.forEach((producto, index) => {
      total += producto.precio;
      listaProductos.innerHTML += `
        <div class="producto-item">
          <div class="producto-nombre">${producto.nombre}</div>
          <div class="producto-info">
            <span class="producto-marca">${producto.marca} - ${producto.linea}</span>
            <div class="producto-acciones">
              <span class="estrella">⭐</span>
              <span class="estrella">⭐</span>
              <span class="estrella">⭐</span>
              <button class="eliminar-producto" onclick="eliminarProducto(${index})">
                Eliminar
              </button>
              <span class="producto-precio">S/ ${producto.precio.toFixed(2)}</span>
            </div>
          </div>
        </div>
      `;
    });
    
    document.getElementById('total-carrito').textContent = `S/ ${total.toFixed(2)}`;
    document.getElementById('total-pago-valor').textContent = total.toFixed(2);
    localStorage.setItem('carrito', JSON.stringify(carrito));
  }

  function eliminarProducto(index) {
    carrito.splice(index, 1);
    actualizarCarrito();
  }

  document.getElementById('btn-realizar-pago').addEventListener('click', function() {
    const usuario = JSON.parse(localStorage.getItem('usuarioActual'));
    if (usuario?.loggedIn) {
      document.querySelector('.metodo-pago').style.display = 'block';
      this.style.display = 'none';
    } else {
      alert('Por favor inicia sesión para continuar con el pago');
      window.location.href = 'registro.html';
    }
  });

  function mostrarFormularioTarjeta() {
    document.querySelector('.formulario-tarjeta').style.display = 'block';
    document.querySelector('.qr-container').style.display = 'none';
    document.querySelectorAll('.opcion-pago').forEach(opcion => {
      opcion.classList.remove('active');
    });
    event.target.classList.add('active');
  }

  function mostrarQR() {
    document.querySelector('.qr-container').style.display = 'block';
    document.querySelector('.formulario-tarjeta').style.display = 'none';
    document.querySelectorAll('.opcion-pago').forEach(opcion => {
      opcion.classList.remove('active');
    });
    event.target.classList.add('active');
  }

  document.getElementById('btn-pagado').addEventListener('click', function() {
    alert('¡Gracias por tu compra! Tu pago está siendo verificado.');
    carrito = [];
    actualizarCarrito();
  });

  function procesarPagoTarjeta() {
    const nombre = document.getElementById('nombre-titular').value.trim();
    const tarjeta = document.getElementById('numero-tarjeta').value.trim();
    const fecha = document.getElementById('fecha-expiracion').value.trim();
    const cvv = document.getElementById('cvv').value.trim();

    if (!nombre || !tarjeta || !fecha || !cvv) {
      alert('Por favor completa todos los campos');
      return;
    }
    
    // Validaciones adicionales...
    alert('¡Pago exitoso! Gracias por tu compra.');
    carrito = [];
    actualizarCarrito();
  }

  actualizarCarrito();
</script>

</body>
</html>
